#summary Analyzepsat UD
<wiki:toc max_depth="2" />

= An illustrated script to using analyzepsat =

Here is some R code to get started
Add your content here.
{{{

# load libraries
library(analyzepsat)
library(trackit)

# load data
data(big.241)
data(gmt3)

# get bathymetry
bath = get.bath.data(-180,-150,-10,50)

# add dummy columns
big.241$sst = 10
big.241$maxz=-10

# run the Kalman filter routine
fit1 = kftrack(big.241[,1:5])

# plot it
.plot3(fit1, map=T, ci=T, points=F, pred=F)
points(fit1$most.prob.track, typ='o', col=4, pch=19, cex=.7)
polygon(gmt3, col = 'black')
title('big.241 most probable track')
 
}}}

http://geolocation.googlecode.com/svn/wiki/images/big241-MPT.jpeg

{{{

# prepare for bathymetric correction
ftrack1 = prepb(fit1, big.241)

# make sure longitude is -180 to 180. We here use the summy column for maxz
ftrack1$Lon_E = ftrack1$Lon_E-360

# Do the bathymetric correction
btrack1 = make.btrack(ftrack1, bath)

# plot it
par(mfrow=c(1,2))
par(mar=c(4,4,6,4))

plot(gmt3, xlim = c(-160, -140)+360, ylim = c(10,25), typ='l', axes=F)
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "lightblue")
plot.btrack(btrack1, map2, offset=0, add=T)
polygon(gmt3, col = 'black')
degAxis(1)
degAxis(2)
.add.month.scale()

plot(gmt3, xlim = c(-160, -140)+360, ylim = c(10,25), typ='l', axes=F)
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "lightblue")
plot.btrack(btrack1, map2, offset=0, add=T, ci=T)
polygon(gmt3, col = 'black')
degAxis(1)
degAxis(2)

}}}

http://geolocation.googlecode.com/svn/wiki/images/big241-btrack.jpeg

{{{

# get the utilization distribution

kd1 = track2KD(btrack1,  xsize= .1,  ysize= .1,  range.x=c(-160, -140)+360, range.y= c(-10,50))
ud1 = kern2UD(kd1)

# plot it 
x11()
mycol = colorRampPalette(c("lightcyan", "royalblue", "blue", "lemonchiffon", "orange", "red"), space = "Lab")
ilabs = c(.1, .3, .5,.75, .95)*100
axis.args=list( at=ilabs, labels=paste0(round(ilabs), '%') )

image(ud, zlim = c(0,.99),  xlim = c(-160, -140)+360, ylim = c(10,25), col = rev(mycol(100)), xlab='', ylab='',add=F, axes=F)
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "lightblue")
image(ud, zlim = c(0,.99),  xlim = c(-160, -140)+360, ylim = c(10,25), col = rev(mycol(100)), xlab='', ylab='',add=T, axes=F)
	degAxis(1); 
	degAxis(2);
	polygon(gmt3, col = 'black')
	box()
	
image.plot(matrix(c(0,100)), col =  rev(mycol(100)), smallplot = c(.65,.70,.25,.85) , legend.only=T, axis.args=axis.args)
}}}
http://geolocation.googlecode.com/svn/wiki/images/big241-UD.jpeg
{{{

# add the track
plot.btrack(btrack1, map2, offset=0, add=T, ci=F)

}}}
http://geolocation.googlecode.com/svn/wiki/images/big241-UD-track.jpeg
= Details =

Add your content here.  Format your content with:
  * Text in *bold* or _italic_
  * Headings, paragraphs, and lists
  * Automatic links to other wiki pages
  
